---
type: "always_apply"
---

# 自動測試規則

## 核心原則
**所有新功能開發和 Bug 修復都必須經過完整的自動化測試驗證後才能報告完成。**

## 測試要求

### 1. 強制自動測試的情況
以下情況**必須**自動執行測試，不得要求用戶手動測試：
- ✅ 新增任何功能（前端/後端/資料庫）
- ✅ 修復任何 Bug
- ✅ 修改現有功能
- ✅ 資料庫 Migration 執行後
- ✅ API 端點新增或修改後
- ✅ 前端頁面新增或修改後

### 2. 測試流程
每次完成開發或修復後，必須按照以下順序執行測試：

#### 步驟 1：後端測試
- 執行資料庫 Migration（如有）
- 使用測試腳本驗證資料庫函數
- 測試 API 端點的回應
- 驗證錯誤處理

#### 步驟 2：前端測試
- 啟動開發伺服器（`npm run dev`）
- 使用瀏覽器自動化工具或腳本測試前端功能
- 驗證頁面載入
- 測試使用者互動（按鈕點擊、表單提交等）
- 檢查響應式設計

#### 步驟 3：整合測試
- 測試前後端整合
- 驗證資料流程（從前端到資料庫）
- 測試錯誤情況和邊界條件

### 3. 測試完成標準
只有當以下所有條件都滿足時，才能向用戶報告「完成」：
- ✅ 所有自動化測試通過（100% 通過率）
- ✅ 沒有 TypeScript 編譯錯誤
- ✅ 沒有 ESLint 警告
- ✅ 開發伺服器成功啟動
- ✅ 前端頁面正常載入且無 JavaScript 錯誤
- ✅ API 端點正常回應
- ✅ 資料庫操作正常執行

### 4. 報告格式
測試完成後，必須提供詳細的測試報告，包含：
- 測試項目清單（前端/後端/資料庫）
- 每個測試的通過/失敗狀態
- 測試通過率統計
- 如有失敗，提供詳細的錯誤訊息和解決方案

### 5. 例外情況（不可抗力）
只有在以下情況下，才可以要求用戶手動測試：
- ❌ 需要特定的用戶權限或帳號才能測試（例如：第三方服務的 API 金鑰）
- ❌ 需要真實的支付流程測試（例如：綠界金流的實際付款）
- ❌ 需要特定的硬體或環境（例如：手機實機測試）
- ❌ 測試工具或環境出現技術性問題無法解決
- ❌ 需要用戶確認 UI/UX 設計是否符合預期

在這些例外情況下，必須：
1. 明確說明為什麼無法自動測試
2. 提供詳細的手動測試步驟
3. 說明已經完成的自動化測試部分

### 6. 測試工具
優先使用以下工具進行自動化測試：
- Node.js 測試腳本（用於 API 和資料庫測試）
- Playwright 或類似工具（用於前端自動化測試）
- `npm run build` 和 `npm run lint`（用於代碼品質檢查）

### 7. 持續改進
- 為每個 Phase 建立專用的測試腳本
- 測試腳本應該可重複執行
- 測試結果應該清晰易讀
- 失敗的測試應該提供明確的錯誤訊息和修復建議

---
type: "always_apply"
---